<!DOCTYPE html>
<html>
<head>
    <title>Emotion Detection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <link rel="manifest" href="/static/manifest.json">
</head>
<body>
    <h1>–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å —Å—Ç—Ä–∞—Ö–∞ üëª:</h1>
    <button id="detect"><h5>–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É</h5></button>
    <div style="display: flex;">
      <h3>–í–∞—à–∞ —ç–º–æ—Ü–∏—è –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç:</h3>
      <h3 id="emotion"></h3>
    </div>
    <div style="display: flex;">
      <h3>–ù–∞–ª–∏—á–∏–µ —Å—Ç—Ä–∞—Ö–∞:</h3>
      <h3 id="is-fear"></h3>
    </div>
    <!-- <video id="video" autoplay playsinline></video> -->
    <!-- <canvas id="canvas" style="display:none;"></canvas> -->
    <img id="output" />

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/static/js/service-worker.js')
                .then(function(registration) {
                    console.log('Service Worker registered with scope:', registration.scope);
                }).catch(function(error) {
                    console.log('Service Worker registration failed:', error);
                });
        }

        const socket = io.connect('http://' + document.domain + ':' + location.port);
        const output = document.getElementById('output');
        const emotionContainer = document.getElementById('emotion');
        const isFearContainer = document.getElementById('is-fear');

        document.getElementById('detect').onclick = function() {
            socket.emit('get_emotion');
        };

        document.getElementById('end_detect').onclick = function() {
            socket.emit('end_emotion');
        };

        socket.on('emotion', function(msg) {
            const data = JSON.parse(msg)
            console.log(data);
            output.src = data.frame;

            emotionContainer.textContent = `${data.emotion}`;
            isFearContainer.textContent = `${data.emotion === 'Fear' ? "True" : "False"}`;
        });
    </script>
</body>
</html>


<!-- <!DOCTYPE html>
<html>
<head>
    <title>Emotion Detection</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
</head>
<body>
    <h1>Emotion Detection</h1>
    <button id="detect">Detect Emotion</button>
    <button id="end_detect">End Emotion</button>

    <ul id="container"></ul>

    <script>
        const socket = io.connect('http://' + document.domain + ':' + location.port);

        document.getElementById('detect').onclick = function() {
            socket.emit('get_emotion');
        };

        document.getElementById('end_detect').onclick = function() {
            socket.emit('end_emotion');
        };

        socket.on('emotion', function(msg) {
            // –ü–æ–ª—É—á–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ div —Å ID 'container'
            var container = document.getElementById('container');

            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ (ul)
            // var ul = document.createElement('ul');

            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç li –∏ –¥–æ–±–∞–≤–ª—è–µ–º –≤ –Ω–µ–≥–æ —Ç–µ–∫—Å—Ç
            var li = document.createElement('li');
            li.textContent = 'Detected emotion: ' + msg.emotion;

            // –î–æ–±–∞–≤–ª—è–µ–º li –≤ ul
            // ul.appendChild(li);

            // –î–æ–±–∞–≤–ª—è–µ–º ul –≤ container
            // container.innerHTML += '<br>'; // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ª—É—á—à–µ–π –≤–∏–¥–∏–º–æ—Å—Ç–∏
            container.appendChild(li);
        });

    </script>
</body>
</html> -->
